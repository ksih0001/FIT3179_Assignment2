<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malaysia Road Safety: Risks, Burden, and Change (2000–2019)</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.28.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.20.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.25.0"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- HEADER -->
    <header class="main-header">
        <h1>Malaysia Road Safety: Risks, Burden, and Change (2000–2019)</h1>
        <p class="subtitle">SEA context (2000–2019) • National outcomes (1997–2016) • State patterns (2003–2019)</p>
        <div class="metadata">
            <p><strong>Author:</strong> Sih Kai Yin (Student ID: 35500336) | <strong>Date:</strong> October 2025</p>
            <p class="data-sources"><strong>Data Sources:</strong> WHO Global Status Reports (2000–2019) • Malaysian Road Safety Reports (1997–2016) • State deaths (2003–2019) • State population (1995–2021)</p>
        </div>
    </header>

    <!-- KEY INSIGHTS -->
    <section class="insights-container">
        <h2>Key Insights (1997–2019)</h2>
        <div class="insights-grid">
            <div class="insight-card">
                <div class="insight-value">+223%</div>
                <div class="insight-label">Registered Vehicles<br>(8.55M → 27.64M)</div>
            </div>
            <div class="insight-card">
                <div class="insight-value">+142%</div>
                <div class="insight-label">Road Crashes<br>(215,632 → 521,466)</div>
            </div>
            <div class="insight-card">
                <div class="insight-value">+13.5%</div>
                <div class="insight-label">Road Deaths<br>(6,302 → 7,152)</div>
            </div>
            <div class="insight-card">
                <div class="insight-value">−35%</div>
                <div class="insight-label">Crash Severity<br>(2.10% → 1.37%)</div>
            </div>
        </div>
    </section>

    <!-- GLOBAL CONTROLS -->
    <section class="controls-container">
        <div class="control-group">
            <label for="global-year-slider">Year:</label>
            <input type="range" id="global-year-slider" min="2003" max="2019" value="2019" step="1">
            <span id="global-year-display" class="year-display">2019</span>
        </div>
    </section>

    <!-- STORYTELLING SECTIONS -->

    <!-- STEP 1: REGIONAL CONTEXT -->
    <section class="chart-section">
        <div class="section-header">
            <h2>Step 1: Regional Context</h2>
            <p class="section-subtitle">Where does Malaysia sit in Southeast Asia?</p>
        </div>
        <div class="chart-container">
            <div class="chart-header">
                <h3>Southeast Asia: Death Rate per 100,000 (<span id="sea-year-display">2019</span>)</h3>
                <div class="control-inline">
                    <label for="sea-year-select">Year:</label>
                    <select id="sea-year-select"></select>
                </div>
            </div>
            <div id="chart1-sea-bar" class="vis-chart"></div>
            <p class="chart-caption">Malaysia ranks mid-high in the region. Thailand consistently shows the highest rates, while Singapore maintains the lowest.</p>
        </div>
    </section>

    <!-- STEP 2: NATIONAL EVOLUTION -->
    <section class="chart-section">
        <div class="section-header">
            <h2>Step 2: National Evolution</h2>
            <p class="section-subtitle">How did exposure and outcomes evolve over time?</p>
        </div>
        <div class="two-column-charts">
            <div class="chart-container">
                <h3>National Outcomes (Counts): Deaths, Serious, Slight (1997–2016)</h3>
                <div id="chart2-stacked-area" class="vis-chart"></div>
                <p class="chart-caption">While crash counts grew dramatically, deaths grew much slower—suggesting improvements in vehicle safety and emergency response.</p>
            </div>
            <div class="chart-container">
                <h3>Exposure vs Incidents: Vehicles, Crashes, Deaths×100 (1997–2016)</h3>
                <div id="chart3-multi-line" class="vis-chart"></div>
                <p class="chart-caption">Vehicle registrations grew 223%, crashes 142%, but deaths only 13.5%—a clear decoupling trend.</p>
            </div>
        </div>
        <div class="narrative-box">
            <h4>The Paradox</h4>
            <p>Malaysia's motorization and crashes rose sharply (1997–2016), but deaths per crash fell by about a third. Safer vehicles, enforcement, and emergency response likely contributed.</p>
        </div>
    </section>

    <!-- STEP 3: SPATIAL PATTERNS -->
    <section class="chart-section">
        <div class="section-header">
            <h2>Step 3: Where Are the Risks?</h2>
            <p class="section-subtitle">Which states are riskiest this year?</p>
        </div>
        <div class="chart-container full-width">
            <h3>State Risk Map: Deaths per 100,000 (Year = <span class="year-linked">2019</span>)</h3>
            <div id="chart4-choropleth" class="vis-chart"></div>
            <p class="chart-caption">Small populations can yield high rates—use the Grouped Bar toggle to inspect absolute burden. Peaks: Perlis & Negeri Sembilan ~29.9; Trough: Sabah ~7.5</p>
        </div>
    </section>

    <!-- STEP 4: STATE COMPARISON -->
    <section class="chart-section">
        <div class="section-header">
            <h2>Step 4: Risk vs Burden This Year</h2>
            <p class="section-subtitle">Which states stand out on risk vs burden?</p>
        </div>
        <div class="two-column-charts">
            <div class="chart-container">
                <div class="chart-header">
                    <h3>State Comparison (Year = <span class="year-linked">2019</span>)</h3>
                    <div class="control-inline">
                        <label class="toggle-label">
                            <input type="checkbox" id="metric-toggle">
                            <span>Show Absolute Deaths</span>
                        </label>
                    </div>
                </div>
                <div id="chart5-grouped-bar" class="vis-chart"></div>
                <p class="chart-caption">Toggle to see both perspectives: rate (risk per person) vs absolute (total burden).</p>
            </div>
            <div class="chart-container">
                <h3>States vs National Rate (Year = <span class="year-linked">2019</span>)</h3>
                <div id="chart8-dot-plot" class="vis-chart"></div>
                <p class="chart-caption">Above the line = above-national risk; below = lower-than-national risk.</p>
            </div>
        </div>
        <div class="narrative-box">
            <h4>Risk vs Burden</h4>
            <p>Rate (risk) shows where people face higher personal danger; absolute (burden) shows where the most deaths occur. Use both lenses to prioritize interventions.</p>
        </div>
    </section>

    <!-- STEP 5: CHANGE OVER TIME -->
    <section class="chart-section">
        <div class="section-header">
            <h2>Step 5: Change Over Time</h2>
            <p class="section-subtitle">Who improved or worsened between two years?</p>
        </div>
        <div class="chart-container">
            <div class="chart-header">
                <h3>Change Over Time: Deaths (Year A vs Year B)</h3>
                <div class="control-inline">
                    <label for="scatter-year-a">Year A:</label>
                    <select id="scatter-year-a"></select>
                    <label for="scatter-year-b">Year B:</label>
                    <select id="scatter-year-b"></select>
                </div>
            </div>
            <div id="chart6-scatter" class="vis-chart"></div>
            <p class="chart-caption">Points above the diagonal = worsened; below = improved. Notable: Perlis +40.7%, W.P. KL −23.4% (2003→2019).</p>
        </div>
    </section>

    <!-- STEP 6: FULL HISTORIES -->
    <section class="chart-section">
        <div class="section-header">
            <h2>Step 6: State Histories</h2>
            <p class="section-subtitle">What does the full 2003–2019 story look like for each state?</p>
        </div>
        <div class="chart-container full-width">
            <h3>State Histories: 2003–2019 (Same Scale)</h3>
            <div id="chart7-trellis" class="vis-chart"></div>
            <p class="chart-caption">Each state's trajectory over 17 years on a consistent scale. Vertical line shows selected year.</p>
        </div>
        <div class="narrative-box">
            <h4>Geography Shifts</h4>
            <p>Risk hot spots are not fixed. Slide the Year to see how states move above or below the national benchmark.</p>
        </div>
    </section>

    <!-- CALL TO ACTION -->
    <section class="cta-section">
        <h2>Call to Action</h2>
        <p>Use <strong>rate (risk)</strong> and <strong>absolute (burden)</strong> together when prioritizing interventions. High-rate states need targeted enforcement and infrastructure; high-burden states need scaled emergency response and trauma care.</p>
    </section>

    <!-- FOOTNOTES -->
    <footer class="footer-notes">
        <h3>Footnotes & Caveats</h3>
        <ul>
            <li>National outcomes are complete to 2016; charts using them (Area, Multi-series Line) stop at 2016 and show a vertical Year guide only when the selected Year is in range.</li>
            <li>2019 state totals (6,167) differ from WHO modeled national total (7,181). Both are labeled where used.</li>
            <li>"W.P. Kuala Lumpur" deaths are paired with Kuala Lumpur population for rate computations.</li>
        </ul>
    </footer>

    <script src="js/dashboard.js"></script>
</body>
</html>
